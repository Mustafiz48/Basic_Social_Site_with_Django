{% load static%}
<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title></title>
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <!------ Include the above in your HEAD tag ---------->

        <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
                crossorigin="anonymous">

        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
                crossorigin="anonymous"></script>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
                crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
                crossorigin="anonymous"></script>
        <link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.5.0/css/all.css' integrity='sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU' crossorigin='anonymous'>


    </head>
    <body>

    <style media="screen">
        body {
            background-color: #eeeeee;
        }

        .h7 {
            font-size: 0.8rem;
        }

        .gedf-wrapper {
            margin-top: 0.97rem;
        }

        @media (min-width: 992px) {
            .gedf-main {
                padding-left: 4rem;
                padding-right: 4rem;
            }
            .gedf-card {
                margin-bottom: 2.77rem;
            }
        }

        .dropdown-toggle::after {
            content: none;
            display: none;
        }
    </style>

    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light" >
      <a class="navbar-brand" href="#">Paper <i style='font-size:20px' class='far'>&#xf5b8;</i></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active" style="margin-left:50%;">
            <a class="nav-link" href="{% url 'link:home' %}"><i style='font-size:25px' class="fas">&#xf015;</i></a>
          </li>
          <li class="nav-item active" style="margin-left:50%;">
            <a class="nav-link" href="{% url 'link:first_app' %}"><i style='font-size:25px' class="fas">&#xf0c0;</i></a>
          </li>
          <li class="nav-item active" style="margin-left:50%;">
            <a class="nav-link" href="{% url 'link:feed' %}"><i style='font-size:24px' class='fas'>&#xf5da;</i></a>
          </li>
          <li class="nav-item active" style="margin-left:50%;">
              <a class="nav-link" href="{% url 'link:profile' %}"><i style='font-size:24px' class='fas'>&#xf4fb;</i></a>
          </li>

          <li class="nav-item active" style="margin-left:50%;">
              <a class="nav-link" href="#"><i style='font-size:24px' class='fas'>&#xf086;</i></a>
          </li>


        </ul>
        <form class="form-inline my-2 my-lg-0">
          <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
      </div>
    </nav>



    <div class="container-fluid gedf-wrapper">
    <div class="row">
        <div class="col-md-3" style="position:fixed">
            <div class="card border-info mb-3">
                <div class="card-body">
                    <img class="rounded-circle" width="105" src={{user.user_signup.propic.url}} alt="">

                    <div class="h7"><h3>{{user.first_name}} {{user.last_name}}</h3></div>
                    <div class="h7">Developer of web applications, JavaScript, PHP, Java, Python, Ruby, Java, Node.js,
                        etc.
                    </div>
                </div>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <div class="h6 text-muted">Following</div>
                        <h5><a class="nav-link" href="{% url 'link:first_app' %}">20 People</a></h5>
                    </li>
                    <li class="list-group-item">
                        <div class="h6 text-muted">Follower</div>
                        <h5><a class="nav-link" href="{% url 'link:first_app' %}">50 People</a></h5>
                    </li>
                    <li class="list-group-item"><a class="nav-link" href="{% url 'link:profile' %}">View Profile</a></li>
                </ul>
            </div>
        </div>

        <div class="col-md-6 gedf-main" style="margin-left:25%">
            <h3 style="color:#138d75">Chat Box:</h3>

<div>
  <!-- <img class="rounded-circle" width="50" src={{user.user_signup.propic.url}} alt="Avatar" > {{username}} -->

  <textarea  id="chat-log" cols="80" rows="17" style="color: #212f3d;font-size:17px;background:white; border-color: #5dade2;border-radius: 2% " ></textarea><br/>
</div>

<!-- <p id="bloop">haaahaahaaa</p> -->

<input id="chat-message-input" type="text" size="90"/><br/>
<input id="chat-message-submit" type="button" value="Send"/>

</div>

</body>
</html>









<script src="{% static 'reconnecting-websocket.js' %}"></script>
<script>
    var roomName = {{ room_name_json }};
    var username = {{ username }};
    var username2=String(username);

    var chatSocket = new ReconnectingWebSocket(
        'ws://' + window.location.host +
        '/ws/chat/' + roomName + '/');

    chatSocket.onmessage = function(e) {
        var data = JSON.parse(e.data);
        var message = data['message'];
        str= String(message);
        var str1=str.substr(0,str.indexOf(' '));
        var str2=str.substr(str.indexOf(' ')+1);

        if(str1==username2){
            document.querySelector('#chat-log').value += ('\n'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+'\t'+ '\t'+'\t'+'\t'+'\t'+'\t'+'\t'+str2 );
        }
        else {
            document.querySelector('#chat-log').value += ('\n'+str1+':'+'\t'+ str2 + '\n' );

        }
        // document.getElementById("bloop").innerHTML=str1;
    };

    chatSocket.onclose = function(e) {
        console.error('Chat socket closed unexpectedly');
    };

    document.querySelector('#chat-message-input').focus();
    document.querySelector('#chat-message-input').onkeyup = function(e) {
        if (e.keyCode === 13) {  // enter, return
            document.querySelector('#chat-message-submit').click();
        }
    };

    document.querySelector('#chat-message-submit').onclick = function(e) {
        var messageInputDom = document.querySelector('#chat-message-input');
        var message =username+' '+ messageInputDom.value;
        chatSocket.send(JSON.stringify({
            'message': message,
            'command': 'new_message',
            'hell': username
        }));

        messageInputDom.value = '';
    };
</script>
</html>
